/**
 * hamsa - A dead simple, data-binding & observable model.
 * @version v0.12.1
 * @link    http://gethamsa.com
 * @author  Javi Jimenez Villar (http://soyjavi.com)
 * @license MIT
 */
(function(){"use strict";var e,t,r,n,o,s,i,u=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1};e=["add","update","delete"],function(c){var a;return a=function(){function c(n,s,i){var c,a,l,f;null==n&&(n={}),null==i&&(i=e),this.constructor.className=this.constructor.name,this.constructor.records[this.uid=o()]=this,l=this.constructor.fields;for(a in l)c=l[a],(n[a]||null!=c["default"])&&("function"==typeof this[a]?this[a](n[a]||c["default"]):this[a]=t(n[a],c));this.observers=[],null!=s?(this.observe(s,i),this.observers.push(s)):!s&&u.call(null!=(f=this.constructor)?f.events:void 0,"update")>=0&&Object.observe(this,function(e){return function(t){var n,o,s,i,c;for(i=[],n=0,o=t.length;o>n;n++)c=t[n],c.object.constructor===e.constructor&&(s=c.name,u.call(e.constructor.names,s)>=0?i.push(r(c,e.constructor)):i.push(void 0));return i}}(this),["update"])}return c.define=function(e){var t;return this.fields=null!=e?e:{},this.events=[],this.names=function(){var e;e=[];for(t in this.fields)e.push(t);return e}.call(this),this.observers=[],this.records={},this},c.all=function(){return this.find()},c.destroyAll=function(){var e;for(e in this.records)delete this.records[e];return this.records},c.find=function(e){var r,n,o,i,u,c,a,l;null==e&&(e={}),i=[],u=this.records;for(a in u){o=u[a],r=!0,c=e.query;for(n in c)l=c[n],r&&t(o[n],this.fields[n])!==l&&(r=!1);r&&i.push(o)}return null!=e.sort&&(n=Object.keys(e.sort)[0],i=s(i,n,e.sort[n])),null!=e.limit?i.slice(0,e.limit):i},c.findOne=function(e){return this.find({query:e})[0]},c.findAndModify=function(e){var t,r,n,o;if(null==e&&(e={}),r=this.findOne(e.query)){n=e.update;for(t in n)o=n[t],r[t]=o}return r||new this(e.update)},c.observe=function(t,r){return this.events=null!=r?r:e,Object.observe(this.records,function(e){return function(r){var o,s,i,u,c,a,l,f;if(n(e.observers,t)){for(l=[],i=0,u=r.length;u>i;i++)f=r[i],o=(null!=(c=e.records[f.name])?c.constructor:void 0)||f.oldValue.constructor,o===e?(s={type:f.type,name:f.name},"add"===(a=f.type)||"update"===a?s.object=e.records[f.name]:s.oldValue=f.oldValue,l.push(t(s))):l.push(void 0);return l}}}(this),this.events),this.observers.push(t),this.observers},c.unobserve=function(e){return this.observers=i(this,e)},c.prototype.observe=function(t,o){return null==o&&(o=e),Object.observe(this,function(e){return function(o){var s,i,c,a,l;if(n(e.observers,t)){for(a=[],s=0,i=o.length;i>s;s++)l=o[s],c=l.name,u.call(e.constructor.names,c)>=0&&(delete l.object.observer,r(l,e.constructor),a.push(t(l)));return a}}}(this),o),this.observers.push(t),this.observers},c.prototype.unobserve=function(e){return this.observers=i(this,e)},c.prototype.destroy=function(e){var t,r,n,o;if(null==e&&(e=!0),e)for(o=this.observers,r=0,n=o.length;n>r;r++)(t=o[r])({type:"destroy",name:this.uid,oldValue:this.fields()});return delete this.constructor.records[this.uid]},c.prototype.fields=function(){var e,t,r,n,o;for(o={},n=this.constructor.names,e=0,t=n.length;t>e;e++)r=n[e],o[r]=this[r];return o},c}(),"function"==typeof define&&define.amd?define(function(){return a}):c.Hamsa=a,"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports=a:void 0}(this),t=function(e,t){return null==t&&(t={type:String}),t.type!==Date&&t.type!==Array?t.type(e||t["default"]):t.type===Array?e||t["default"]:e||t.type(t["default"])},r=function(e,t){var r,n,o,s,i,c;for(s=t.observers,c=[],r=0,n=s.length;n>r;r++)o=s[r],"update"===e.type&&(i=e.type,u.call(t.events,i)>=0)?(delete e.object.observer,c.push(o(e))):c.push(void 0);return c},n=function(e,t){var r,n,o,s;for(r=!1,n=0,o=e.length;o>n;n++)if(s=e[n],s===t){r=!0;break}return r},o=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t,r;return t=16*Math.random()|0,r="x"===e?t:3&t|8,r.toString(16)}).toUpperCase()},s=function(e,t,r){return e.sort(function(e,n){return e[t]>n[t]?-1*r:e[t]<n[t]?1*r:0})},i=function(e,t){var r,n,o,s,i;for(i=e.observers,r=n=0,o=i.length;o>n;r=++n)if(s=i[r],t){if(s===t){Object.unobserve(e,s),e.observers.splice(r,1);break}}else Object.unobserve(e,s);return t||(e.observers=[]),e.observers},window._extends=function(e,t){var r,n;r=function(){this.constructor=e};for(n in t)_hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},window._hasProp={}.hasOwnProperty,Object.observe||function(t,r,n){var o,s,i,c,a,l,f,d,h,p;return e=["add","update","delete"],c=r.indexOf||function(e,t,n){return r.prototype.indexOf.call(e,t,n)},a=n.requestAnimationFrame||n.webkitRequestAnimationFrame||function(){var e,t;return e=+new Date,t=e,function(r){var n;return n=+new Date,setTimeout(function(){return r((t=+new Date)-e)},17)}}(),l=function(e,t,r){var n,o,s,i;return n=f.get(e),n?p(e,n,t,r):(s=Object.getOwnPropertyNames(e),n={handlers:new Map,properties:s,values:function(){var t;t=[];for(o in e)i=e[o],u.call(s,o)>=0&&t.push(i);return t}()},f.set(e,n),p(e,n,t,r),1===f.size?a(h):void 0)},p=function(e,t,r,n){var o;return o=i.get(r),o||i.set(r,o={observed:new Map,changeRecords:[]}),o.observed.set(e,{events:n,data:t}),t.handlers.set(r,o)},d=function(e,t,r){var n,s,i,u,a,l,f,d,h,p,v;if(e.handlers.size){for(v=e.values,a=Object.getOwnPropertyNames(t),d=e.properties.slice(),h=d.length,i=0,l=a.length;l>i;i++)u=a[i],s=c(d,u),p=t[u],-1===s?(o(t,e,{name:u,type:"add",object:t},r),e.properties.push(u),v.push(p)):(f=v[s],d[s]=null,h--,(f===p?0===f&&1/f!==1/p:f===f||p===p)&&(o(t,e,{name:u,type:"update",object:t,oldValue:f},r),e.values[s]=p));for(n=d.length;h&&n--;)null!==d[n]&&(o(t,e,{name:d[n],type:"delete",object:t,oldValue:v[n]},r),e.properties.splice(n,1),e.values.splice(n,1),h--)}},o=function(e,t,r,n){t.handlers.forEach(function(t){var o;o=t.observed.get(e).events,("string"!=typeof n||-1===c(o,n))&&c(o,r.type)>-1&&t.changeRecords.push(r)})},h=function(){f.size&&(f.forEach(d),i.forEach(s),a(h))},s=function(e,t){e.changeRecords.length&&(t(e.changeRecords),e.changeRecords=[])},f=new Map,i=new Map,t.observe=function(r,n,o){if(null==o&&(o=e),!r||"object"!=typeof r&&"function"!=typeof r)throw new TypeError("Object.observe cannot observe non-object");if("function"!=typeof n)throw new TypeError("Object.observe cannot deliver to non-function");if(t.isFrozen&&t.isFrozen(n))throw new TypeError("Object.observe cannot deliver to a frozen function object");if(arguments.length>2&&"object"!=typeof o)throw new TypeError("Object.observe cannot use non-object accept list");return l(r,n,o),r},t.unobserve=function(e,t){var r,n;if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object.unobserve cannot unobserve non-object");if("function"!=typeof t)throw new TypeError("Object.unobserve cannot deliver to non-function");return r=i.get(t),n=void 0,r&&(n=r.observed.get(e))&&(r.observed.forEach(function(e,t){d(e.data,t)}),a(function(){s(r,t)}),1===r.observed.size&&r.observed.has(e)?i["delete"](t):r.observed["delete"](e),1===n.data.handlers.size?f["delete"](e):n.data.handlers["delete"](t)),e}}(Object,Array,this)}).call(this);